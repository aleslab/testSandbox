%Z = [[227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.536277955388;229.425112306902;225.496506390365;231.662522032417;238.333920657979;242.296349667339;248.161068051215;250.558489418727;255.876587853745;257.120246457936;260.979436143658;249.290604918006;249.975933712568;235.062968808766;228.590873370955;241.824833279502;236.769975314722;232.217708614430;236.385955781657;234.379479417701;241.666282158242;238.140338094539;236.451033995974;242.814693795873;238.642573048692;236.900707218059;241.722398602224;239.838001486352;240.134963627560;245.099217307377;250.839215972152;253.038871940100;247.351675944843;247.999593128598;245.980612215348;244.066950007825;246.409228288819;240.296321391497;240.142953907489;245.948916305080;251.986628508466;255.333849253918;249.498576386119;240.197676849829;243.516532621345;239.622472244678;243.507205300525;248.387635511131;245.609856089202;249.442347069529;245.789023347390;244.108504681144;238.206045083180;232.995203563587;233.476864366930;240.910371545130;246.612564830381;245.710286418619;243.097524690228;233.420311217857;231.597149485132;229.525320672162;239.986162925080;239.534355361186;248.873083414532;246.871304470752;247.322463704940;247.134519186016;249.342690151478;241.008480435822;236.156284612389;238.523610370981;233.985516093629;228.568611530941;239.005396028682;232.193056514414;243.355807446822;246.166351054093;243.905352898509;246.103052931005;244.946218047567;253.832491965420;247.802595121018;248.290531468992;251.807237574866;248.582244003747;250.346693452198;257.691081061920;259.952480556700;265.483428787209;266.467305443114;262.890331118950;264.362035094663;259.034958006832;259.040024187108;251.141739675246;257.565367039858;258.589961667008;252.253899892354;247.514929925712;251.073082151198;254.871259466781;248.092662694463;242.863619869345;243.393978887293;253.890104357312;261.962740956740;262.215501883841;260.993521625129;260.835142675400;261.163123420019;272.439102479575;273.324475216978;279.438259349616;272.387529123828;270.422005213238;264.947810112176;265.470818252298;263.385565000407;265.094969357228;277.207240935360;271.222870745639;276.722060416431;271.374253241068;277.137268774554;276.027268123221;277.827595430793;279.568921143331;280.577379303832;282.978830554206;281.054614663168;281.441994600818;280.751885281226;282.285830290220;287.259623093122;283.871279211200;273.035860193708;278.061592176917;278.197434260320;274.347061230387;278.988829085948;275.680835734214;277.491658808193;275.140054120485;271.954392122548;272.633434610334;272.181048742763;271.537171401121;276.874558370884;276.658058313264;273.247892449613;271.468822792915;272.606169469323;268.661081326737;262.973720062974;272.439516473854;275.541771974132;270.697557914192;275.630706158575;273.033968733997;280.523963336389;270.987403349134;271.402073878922;266.353829648551;265.678189433503;261.483036665045;262.903916802850;270.144268483896;280.199398988729;281.158864718807;277.196429803148;278.788789326164;273.791091841752;278.296183606283;284.198332910278;275.530069248574;267.822923604987;266.601272428373;265.097169793019;264.143749986298]];

Z=experimentData(1).trialData.respOri;

%[[227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.649328641147;227.536277955388;229.425112306902;225.496506390365;231.662522032417;238.333920657979;242.296349667339;248.161068051215;250.558489418727;255.876587853745;257.120246457936;260.979436143658;249.290604918006;249.975933712568;235.062968808766;228.590873370955;241.824833279502;236.769975314722;232.217708614430;236.385955781657;234.379479417701;241.666282158242;238.140338094539;236.451033995974;242.814693795873;238.642573048692;236.900707218059;241.722398602224;239.838001486352;240.134963627560;245.099217307377;250.839215972152;253.038871940100;247.351675944843;247.999593128598;245.980612215348;244.066950007825;246.409228288819;240.296321391497;240.142953907489;245.948916305080;251.986628508466;255.333849253918;249.498576386119;240.197676849829;243.516532621345;239.622472244678;243.507205300525;248.387635511131;245.609856089202;249.442347069529;245.789023347390;244.108504681144;238.206045083180;232.995203563587;233.476864366930;240.910371545130;246.612564830381;245.710286418619;243.097524690228;233.420311217857;231.597149485132;229.525320672162;239.986162925080;239.534355361186;248.873083414532;246.871304470752;247.322463704940;247.134519186016;249.342690151478;241.008480435822;236.156284612389;238.523610370981;233.985516093629;228.568611530941;239.005396028682;232.193056514414;243.355807446822;246.166351054093;243.905352898509;246.103052931005;244.946218047567;253.832491965420;247.802595121018;248.290531468992;251.807237574866;248.582244003747;250.346693452198;257.691081061920;259.952480556700;265.483428787209;266.467305443114;262.890331118950;264.362035094663;259.034958006832;259.040024187108;251.141739675246;257.565367039858;258.589961667008;252.253899892354;247.514929925712;251.073082151198;254.871259466781;248.092662694463;242.863619869345;243.393978887293;253.890104357312;261.962740956740;262.215501883841;260.993521625129;260.835142675400;261.163123420019;272.439102479575;273.324475216978;279.438259349616;272.387529123828;270.422005213238;264.947810112176;265.470818252298;263.385565000407;265.094969357228;277.207240935360;271.222870745639;276.722060416431;271.374253241068;277.137268774554;276.027268123221;277.827595430793;279.568921143331;280.577379303832;282.978830554206;281.054614663168;281.441994600818;280.751885281226;282.285830290220;287.259623093122;283.871279211200;273.035860193708;278.061592176917;278.197434260320;274.347061230387;278.988829085948;275.680835734214;277.491658808193;275.140054120485;271.954392122548;272.633434610334;272.181048742763;271.537171401121;276.874558370884;276.658058313264;273.247892449613;271.468822792915;272.606169469323;268.661081326737;262.973720062974;272.439516473854;275.541771974132;270.697557914192;275.630706158575;273.033968733997;280.523963336389;270.987403349134;271.402073878922;266.353829648551;265.678189433503;261.483036665045;262.903916802850;270.144268483896;280.199398988729;281.158864718807;277.196429803148;278.788789326164;273.791091841752;278.296183606283;284.198332910278;275.530069248574;267.822923604987;266.601272428373;265.097169793019;264.143749986298]]
Xinitial_time_point = 0;
Pinitial=1;
R=0.3
Xhat(1)=Xinitial_time_point;
P(1)=Pinitial;
K(1)=P(1)/(P(1)+R);
Xhat (1)= Xhat(1)+ K(1)*(Z(1)-Xhat(1));
P(1)=(1-K(1))*P(1);
for k=1:210, 
    Xhat(k)=Xhat(k-1);
    P(k)=P(k-1);
    K(k)=P(k)/(P(k)+R);%measurement update
    Xhat(k)=Xhat(k)+ K(k)*(Z(k)-Xhat(k));
    P(k)=(1-K(k))*P(k);
   
end
plot(Z, Xhat)
grid on


